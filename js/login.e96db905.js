"use strict";(self.webpackChunkant_design_vue_pro=self.webpackChunkant_design_vue_pro||[]).push([[535],{13796:function(e,a,t){t.d(a,{Z:function(){return r}});var l=t(80707);class r{static login(e){return l.Z.request({url:"/login/account",method:"post",data:e})}static getUserInfo(){return l.Z.request({url:"/currentUser",method:"get"})}static logout(){return l.Z.request({url:"/logout",method:"post"})}static register(e){return l.Z.request({url:"/register",method:"post",data:e})}}},65920:function(e,a,t){t.r(a),t.d(a,{default:function(){return y}});var l=t(66252);const r=(0,l.HX)("data-v-14879de8");(0,l.dD)("data-v-14879de8");const o={class:"main login"},n=(0,l.Uk)(" 获取验证码 "),s=(0,l.Uk)(" 自动登录 "),i=(0,l.Uk)(" 忘记密码 "),u=(0,l.Uk)(" 登录 "),c={class:"user-login-other"},m=(0,l.Wm)("span",null,"其他登录方式",-1),d=(0,l.Uk)(" 注册账户 ");(0,l.Cn)();const p=r(((e,a,t,p,f,g)=>{const v=(0,l.up)("a-alert"),h=(0,l.up)("user-outlined"),b=(0,l.up)("a-input"),W=(0,l.up)("a-form-item"),y=(0,l.up)("lock-outlined"),k=(0,l.up)("a-input-password"),_=(0,l.up)("a-tab-pane"),w=(0,l.up)("mobile-outlined"),U=(0,l.up)("mail-outlined"),q=(0,l.up)("a-col"),C=(0,l.up)("a-button"),I=(0,l.up)("a-row"),x=(0,l.up)("a-tabs"),Z=(0,l.up)("a-checkbox"),z=(0,l.up)("router-link"),K=(0,l.up)("alipay-circle-outlined"),j=(0,l.up)("taobao-circle-outlined"),S=(0,l.up)("weibo-circle-outlined"),M=(0,l.up)("a-form");return(0,l.wg)(),(0,l.j4)("div",o,[(0,l.Wm)(M,{layout:"vertical",model:e.form,onSubmit:e.handleSubmit},{default:r((()=>[(0,l.Wm)(x,{"active-key":e.activeKey,"tab-bar-style":{textAlign:"center",borderBottom:"unset"},onChange:e.handleTabClick},{default:r((()=>[(0,l.Wm)(_,{key:0,tab:"账号密码登录"},{default:r((()=>[e.isLoginError?((0,l.wg)(),(0,l.j4)(v,{key:0,type:"error","show-icon":"",style:{"margin-bottom":"24px"},message:"账户或密码错误"})):(0,l.kq)("",!0),(0,l.Wm)(W,e.validateInfos.username,{default:r((()=>[(0,l.Wm)(b,{size:"large",value:e.form.username,"onUpdate:value":a[1]||(a[1]=a=>e.form.username=a),placeholder:"账户: admin"},{prefix:r((()=>[(0,l.Wm)(h,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16),(0,l.Wm)(W,e.validateInfos.password,{default:r((()=>[(0,l.Wm)(k,{size:"large",value:e.form.password,"onUpdate:value":a[2]||(a[2]=a=>e.form.password=a),placeholder:"密码: admin or ant.design"},{prefix:r((()=>[(0,l.Wm)(y,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16)])),_:1}),(0,l.Wm)(_,{key:1,tab:"手机号登录"},{default:r((()=>[(0,l.Wm)(W,e.validateInfos.mobile,{default:r((()=>[(0,l.Wm)(b,{size:"large",value:e.form.mobile,"onUpdate:value":a[3]||(a[3]=a=>e.form.mobile=a),placeholder:"手机号"},{prefix:r((()=>[(0,l.Wm)(w,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16),(0,l.Wm)(I,{gutter:16},{default:r((()=>[(0,l.Wm)(q,{span:16},{default:r((()=>[(0,l.Wm)(W,e.validateInfos.captcha,{default:r((()=>[(0,l.Wm)(b,{size:"large",value:e.form.captcha,"onUpdate:value":a[4]||(a[4]=a=>e.form.captcha=a),placeholder:"验证码"},{prefix:r((()=>[(0,l.Wm)(U,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16)])),_:1}),(0,l.Wm)(q,{span:8},{default:r((()=>[(0,l.Wm)(C,{size:"large",block:"",onClick:e.getCaptcha},{default:r((()=>[n])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["active-key","onChange"]),(0,l.Wm)(W,null,{default:r((()=>[(0,l.Wm)(Z,{checked:e.form.rememberMe,"onUpdate:checked":a[5]||(a[5]=a=>e.form.rememberMe=a)},{default:r((()=>[s])),_:1},8,["checked"]),(0,l.Wm)(z,{to:"/user/login",class:"forge-password",style:{float:"right"}},{default:r((()=>[i])),_:1})])),_:1}),(0,l.Wm)(W,{style:{"margin-top":"24px"}},{default:r((()=>[(0,l.Wm)(C,{size:"large",type:"primary",loading:e.loading,"html-type":"submit",block:""},{default:r((()=>[u])),_:1},8,["loading"])])),_:1}),(0,l.Wm)("div",c,[m,(0,l.Wm)("a",null,[(0,l.Wm)(K,{class:"item-icon"})]),(0,l.Wm)("a",null,[(0,l.Wm)(j,{class:"item-icon"})]),(0,l.Wm)("a",null,[(0,l.Wm)(S,{class:"item-icon"})]),(0,l.Wm)(z,{class:"register",to:"/user/register"},{default:r((()=>[d])),_:1})])])),_:1},8,["model","onSubmit"])])}));var f=t(2262),g=t(80894),v=t(42119),h=t(30571),b=t(13796),W=(0,l.aZ)({name:"login",setup(){const e=(0,g.oR)(),a=(0,v.tv)(),t=(0,f.qj)({activeKey:0,loading:!1,isLoginError:!1}),l=(0,f.qj)({rememberMe:!0,username:"",password:"",mobile:"",captcha:""}),r=(0,f.qj)({rememberMe:void 0,username:[{required:!0,message:"请输入帐户名"}],password:[{required:!0,message:"请输入密码"}],mobile:[{required:!0,pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号"}],captcha:[{required:!0,message:"请输入验证码"}]}),{validateInfos:o,validate:n,resetFields:s}=(0,h.Z)(l,r);return{...(0,f.BK)(t),form:l,validateInfos:o,handleTabClick:function(e){t.activeKey=e,s()},getCaptcha:async function(e){try{e.preventDefault(),await n("mobile")}catch(e){}},handleSubmit:async function(l){try{t.loading=!0,l.preventDefault();const r=0===t.activeKey?["username","password"]:["mobile","captcha"],o=await n(r);o.type=0===t.activeKey?"account":"telephone";const{token:s}=await b.Z.login(o),i=await b.Z.getUserInfo(),{name:u,userid:c,avatar:m}=i;await e.dispatch("setLoginStatus",1),await e.dispatch("setAccessToken",s);const d={username:c,nickname:u,avatar:m,extra:i};await e.dispatch("setUserInfo",d),await a.push({path:"/"}),t.loading=!1}catch(e){t.loading=!1}}}}});W.render=p,W.__scopeId="data-v-14879de8";var y=W}}]);