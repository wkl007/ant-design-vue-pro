(self.webpackChunkant_design_vue_pro=self.webpackChunkant_design_vue_pro||[]).push([[474],{44863:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(80707);class l{static getRoles(e){return a.Z.request({url:"/roles",method:"get",params:e})}static getPermissions(e){return a.Z.request({url:"/permissions",method:"get",params:e})}}},31696:function(e,t,n){"use strict";n.d(t,{$5:function(){return a.$5},O9:function(){return c},yW:function(){return r}});var a=n(98333),l=n(2262),i=n(66252),o=n(57974);function c(e){const{onExitFull:t,onFull:n}=e||{},a=(0,l.iH)(null),c=(0,l.iH)(t),d=(0,l.iH)(n),r=(0,l.iH)(!1);function u(){if(o.I5.isEnabled){const{isFullscreen:e}=o.I5;e?d.value&&d.value():(o.I5.off("change",u),c.value&&c.value()),r.value=e}}function s(){const e=function(e,t){if(!e)return t;let n;return n="function"==typeof e?e():"value"in e?e.value?.$el:e,n}(a);e&&o.I5.isEnabled&&(o.I5.request(e),o.I5.on("change",u))}function m(){r.value&&o.I5.isEnabled&&o.I5.exit()}return(0,i.Ah)((()=>{o.I5.isEnabled&&o.I5.off("change",u)})),[a,r,{setFull:s,exitFull:m,toggleFull:function(){r.value?m():s()}}]}n(86509),n(15862);const d={align:"center",title:"序号",dataIndex:"my-custom-show-index",customRender:({index:e})=>`${e+1}`};function r(e,t){const n="boolean"==typeof t?{checkAll:t,needRowIndex:!1}:{checkAll:!!t.checkAll,needRowIndex:!!t.needRowIndex},a=(0,l.qj)({checkAll:n.checkAll,needRowIndex:n.needRowIndex,checkedList:[],indeterminate:!0}),o=(0,l.iH)([...e]);n.needRowIndex&&o.value.unshift(d);const c=(0,l.iH)(e.map((e=>({key:e?.key||e.dataIndex,label:e.title,checked:n.checkAll})))),r=c.value.map((e=>e.key));function u(){const t=c.value.map((e=>e.key));o.value=e.filter((e=>a.checkedList.includes(e.dataIndex))).sort(((e,n)=>{const a=e.key||e.dataIndex,l=n.key||n.dataIndex;return t.indexOf(a)-t.indexOf(l)})).map((e=>e)),n.needRowIndex&&o.value.unshift(d)}return a.checkedList=r,a.checkAll=n.checkAll,a.indeterminate=!n.checkAll,(0,i.YP)((()=>a.checkedList),(()=>{a.checkAll=!!a.checkedList.length&&a.checkedList.length===r.length,a.indeterminate=!!a.checkedList.length&&a.checkedList.length<r.length,u()}),{deep:!0}),(0,i.YP)((()=>c),(()=>u()),{deep:!0}),{dynamicColumns:o,dynamicColumnItems:c,state:a,reset:function(){a.checkedList=r,c.value=e.map((e=>({key:e?.key||e.dataIndex,label:e.title,checked:n.checkAll})))},move:function(e,t){const n=c.value,a=n[e];n.splice(e,1),0===t?n.unshift(a):n.splice(t,0,a),c.value=n},handleColumnAllClick:function(e){const t=e.target.checked;a.checkedList=t?r:[],c.value=c.value.map((e=>(e.checked=t,e)))},handleColumnChange:function(e,t){const n=e.target.checked;t.checked=n,n?!a.checkedList.includes(t.key)&&a.checkedList.push(t.key):a.checkedList=a.checkedList.filter((e=>e!==t.key))}}}},98333:function(e,t,n){"use strict";n.d(t,{re:function(){return o},$5:function(){return c}});var a=n(2262),l=n(66252);const i={stripe:!1,loading:!1,current:1,pageSize:20,total:0,dataSource:[]},o=e=>()=>e().then((e=>({data:e,total:e.length,success:!0})));function c(e,t,n){const o=(0,a.qj)({...i,...t});async function c(){try{if(o.loading)return;o.loading=!0;const{pageSize:t=20,current:a=1}=o,l=!1!==n?.pagination?{current:a,pageSize:t,...o.requestParams}:void 0,{data:i,success:c,total:d=0}=await e(l);o.loading=!1,!1!==c&&(o.dataSource=i,o.total=d)}catch(e){if(o.loading=!1,void 0===n?.onRequestError)throw new Error(e);n.onRequestError(e)}}return(0,l.bv)((()=>{c().catch((e=>{throw new Error(e)}))})),{context:o,stripe:function(e,t){return t%2==1&&o.stripe&&"ant-pro-table-row-striped"},cancel:function(){},reset:function(){},reload:function(){return new Promise((e=>{e(c())}))},resetPageIndex:function(){o.current=1},setPageInfo:e=>{var t;(t={current:o.current,pageSize:o.pageSize,...e}).current&&(o.current=t.current),t.pageSize&&(o.pageSize=t.pageSize),o.requestParams=t}}}},88890:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var a=n(66252),l=n(3577);const i={class:"ant-pro-table"},o={class:"ant-pro-table-search"},c=(0,a.Uk)(" 新增角色 "),d={class:"table-role-permission-card"};var r=n(2262),u=n(83650),s=n(49963);const m={style:{marginRight:"8px"}};var h,f=n(26640);!function(e){e.ADD="add",e.DELETE="delete",e.UPDATE="update",e.QUERY="query",e.IMPORT="import",e.EXPORT="export"}(h||(h={}));var p=(0,a.aZ)({name:"RoleModal",props:{visible:{type:Boolean,default:!1},model:{type:Object,default:()=>{}}},emits:["cancel"],setup(){const e=(0,r.qj)({id:0,name:void 0,describe:void 0,permissions:[]}),t=(0,r.qj)({id:[{required:!0}],name:[{required:!0}]}),n=(0,r.iH)([{id:"roleManage",name:"角色管理",actions:[h.ADD,h.UPDATE]},{id:"userManage",name:"用户管理",actions:[h.ADD,h.UPDATE,h.QUERY]}]),a=(0,r.iH)([]),{validateInfos:l,resetFields:i}=(0,f.Z)(e,t);return{tags:[{key:"add",describe:"新增"},{key:"update",describe:"修改"},{key:"delete",describe:"删除"},{key:"query",describe:"查询"},{key:"import",describe:"导入"},{key:"export",describe:"导出"}],rolePermissions:n,selectedTags:a,modelRef:e,validateInfos:l,resetFields:i,handleSubmit:function(){},handleChange:function(e,t,n){if(n)e.push(t.key);else{const n=e.findIndex((e=>e===t.key));e.splice(n,1)}}}}});p.render=function(e,t,n,i,o,c){const d=(0,a.up)("a-input"),r=(0,a.up)("a-form-item"),u=(0,a.up)("a-checkable-tag"),h=(0,a.up)("a-form"),f=(0,a.up)("a-modal");return(0,a.wg)(),(0,a.j4)(f,{title:"权限编辑",visible:e.visible,width:600,centered:"",onOk:e.handleSubmit,onCancel:t[2]||(t[2]=()=>{e.resetFields(),e.$emit("cancel")})},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{layout:"vertical"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(r,(0,a.dG)({label:"唯一编号"},e.validateInfos.id),{default:(0,a.w5)((()=>[(0,a.Wm)(d,{value:e.modelRef.id,disabled:"",placeholder:"唯一编号"},null,8,["value"])])),_:1},16),[[s.F8,e.modelRef.id>0]]),(0,a.Wm)(r,(0,a.dG)({label:"角色名称"},e.validateInfos.name),{default:(0,a.w5)((()=>[(0,a.Wm)(d,{value:e.modelRef.name,"onUpdate:value":t[1]||(t[1]=t=>e.modelRef.name=t),placeholder:"角色名称"},null,8,["value"])])),_:1},16),(0,a.Wm)(r,{label:"角色权限表"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.rolePermissions,(t=>((0,a.wg)(),(0,a.j4)("p",{key:t.id,style:{"margin-left":"12px"}},[(0,a.Wm)("span",m,(0,l.zw)(t.name)+":",1),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.tags,(n=>((0,a.wg)(),(0,a.j4)(u,{key:n.key,checked:t.actions.indexOf(n.key)>-1,onChange:a=>e.handleChange(t.actions,n,a)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(n.describe),1)])),_:2},1032,["checked","onChange"])))),128))])))),128))])),_:1})])),_:1})])),_:1},8,["visible","onOk"])};var g=p,k=n(31696),v=n(44863);const b=[{align:"center",title:"编号",dataIndex:"id"},{align:"center",title:"角色名称",dataIndex:"name"},{align:"center",title:"描述",dataIndex:"describe"},{align:"center",title:"操作",dataIndex:"action",slots:{customRender:"action"}}];var w=(0,a.aZ)({name:"RoleList",components:{TableToolbar:u.fj,RoleModal:g},setup(){const e=(0,r.qj)({roleModal:(0,r.iH)(),visible:!1,currentData:{}}),{state:t,dynamicColumns:n,dynamicColumnItems:l,handleColumnAllClick:i,handleColumnChange:o,reset:c,move:d}=(0,k.yW)(b,{checkAll:!0,needRowIndex:!1}),[u,s,{setFull:m,exitFull:h}]=(0,k.O9)(),{context:f,reload:p,setPageInfo:g}=(0,k.$5)(v.Z.getRoles,{current:1,pageSize:10,tableSize:"middle"});return{...(0,r.BK)(e),state:f,columnState:t,dynamicColumns:n,dynamicColumnItems:l,elRef:u,screenState:s,setFull:m,exitFull:h,reset:c,move:d,handleTableChange:function({current:e,pageSize:t},n){g({current:e,pageSize:t,...n}),p()},handleColumnChange:o,handleColumnAllClick:i,handleReload:function(){g({current:1,pageSize:10}),p()},handleModalVisible:function(t,n){e.visible=t,e.currentData=n,t&&n.id&&(0,a.Y3)((()=>{e.roleModal.modelRef.id=n.id,e.roleModal.modelRef.name=n.name,e.roleModal.modelRef.describe=n.describe,e.roleModal.modelRef.permissions=n.permissions}))}}}});w.render=function(e,t,n,r,u,s){const m=(0,a.up)("a-input"),h=(0,a.up)("a-form-item"),f=(0,a.up)("a-col"),p=(0,a.up)("a-row"),g=(0,a.up)("a-form"),k=(0,a.up)("plus-outlined"),v=(0,a.up)("a-button"),b=(0,a.up)("table-toolbar"),w=(0,a.up)("a-tag"),y=(0,a.up)("a-table"),x=(0,a.up)("a-card"),C=(0,a.up)("role-modal"),I=(0,a.up)("page-container");return(0,a.wg)(),(0,a.j4)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)("div",i,[(0,a.Wm)("div",o,[(0,a.Wm)(g,{layout:"horizontal"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{gutter:16,type:"flex",justfy:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{xs:24,sm:24,md:12},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{label:"角色名称"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{placeholder:"角色名称"})])),_:1})])),_:1}),(0,a.Wm)(f,{xs:24,sm:24,md:12},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{label:"描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{placeholder:"描述"})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,a.Wm)(x,{"body-style":{padding:0},ref:"elRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{title:"角色列表","screen-state":e.screenState,indeterminate:e.columnState.indeterminate,"column-items":e.dynamicColumnItems,"table-size":e.state.tableSize,"onUpdate:table-size":t[2]||(t[2]=t=>e.state.tableSize=t),"check-all":e.columnState.checkAll,"onUpdate:check-all":t[3]||(t[3]=t=>e.columnState.checkAll=t),onReload:e.handleReload,onReset:e.reset,onSetFull:e.setFull,onExitFull:e.exitFull,onChange:e.handleColumnChange,onChangeAll:e.handleColumnAllClick,onMove:e.move},{action:(0,a.w5)((()=>[(0,a.Wm)(v,{type:"primary",onClick:t[1]||(t[1]=t=>e.handleModalVisible(!0,{}))},{default:(0,a.w5)((()=>[(0,a.Wm)(k),c])),_:1})])),_:1},8,["screen-state","indeterminate","column-items","table-size","check-all","onReload","onReset","onSetFull","onExitFull","onChange","onChangeAll","onMove"]),(0,a.Wm)(y,{"row-key":"id",size:e.state.tableSize,loading:e.state.loading,columns:e.dynamicColumns,"data-source":e.state.dataSource,pagination:{current:e.state.current,pageSize:e.state.pageSize,total:e.state.total},onChange:e.handleTableChange},{expandedRowRender:(0,a.w5)((({record:e})=>[(0,a.Wm)("div",d,[(0,a.Wm)(p,{gutter:12},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.permissions,(e=>((0,a.wg)(),(0,a.j4)(f,{style:{height:"48px"},span:12,key:e.id},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{gutter:16},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{span:4},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(e.label),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.actions,(e=>((0,a.wg)(),(0,a.j4)(w,{color:"cyan",key:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(e),1)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])])),action:(0,a.w5)((({record:t})=>[(0,a.Wm)("a",{href:"javascript:;",onClick:n=>e.handleModalVisible(!0,t)}," 编辑 ",8,["onClick"])])),_:1},8,["size","loading","columns","data-source","pagination","onChange"])])),_:1},512)]),(0,a.Wm)(C,{ref:"roleModal",model:e.currentData,visible:e.visible,onCancel:t[4]||(t[4]=t=>e.handleModalVisible(!1,e.currentData))},null,8,["model","visible"])])),_:1})};var y=w}}]);