(self.webpackChunkant_design_vue_pro=self.webpackChunkant_design_vue_pro||[]).push([[4535],{55518:function(e,t,r){"use strict";r.d(t,{cI:function(){return S}});var a=r(44854),n=r(66252),i=r(42151),o=r(80758),l=r(41597),u=r(60665),c=r(72563),s=r(4827),d=r(76273),f=Math.min;var m=function(e,t,r){for(var a=r?c.Z:u.Z,n=e[0].length,i=e.length,m=i,v=Array(i),p=1/0,g=[];m--;){var h=e[m];m&&t&&(h=(0,o.Z)(h,(0,s.Z)(t))),p=f(h.length,p),v[m]=!r&&(t||n>=120&&h.length>=120)?new l.Z(m&&h):void 0}h=e[0];var b=-1,y=v[0];e:for(;++b<n&&g.length<p;){var k=h[b],w=t?t(k):k;if(k=r||0!==k?k:0,!(y?(0,d.Z)(y,w):a(g,w,r))){for(m=i;--m;){var W=v[m];if(!(W?(0,d.Z)(W,w):a(e[m],w,r)))continue e}y&&y.push(w),g.push(k)}}return g},v=r(8901),p=r(34096);var g=function(e){return(0,p.Z)(e)?e:[]},h=(0,v.Z)((function(e){var t=(0,o.Z)(e,g);return t.length&&t[0]===e[0]?m(t):[]})),b=r(65741),y=r(16152),k=r(77186),w=r(18688),W=r(30144),_=r(57493);function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){j(e,t,r[t])}))}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function q(e){var t=!1;return e&&e.length&&e.every((function(e){return!e.required||(t=!0,!1)})),t}function I(e){return null==e?[]:Array.isArray(e)?e:[e]}(0,r(86236).bc)("","success","warning","error","validating");function U(e,t,r){for(var a=e,n=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0,o=n.length;i<o-1&&(a||r);++i){var l=n[i];if(!(l in a)){if(r)throw new Error("please transfer a valid name path to validate!");break}a=a[l]}return{o:a,k:n[i],v:a?a[n[i]]:null,isValid:a&&n[i]in a}}var S=function(e,t,r){var o=(0,i.Z)(e),l={};Object.keys(t).forEach((function(e){l[e]={autoLink:!1,required:q(t[e])}})),l=(0,a.qj)(l);var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.length?e.filter((function(e){var r=I(e.trigger||"change");return h(r,t).length})):e},c=null,s=function(e,t,r,a){var n=(0,w.N)([e],t,r,Z({validateMessages:W.y},a),!!a.validateFirst);return l[e].validateStatus="validating",n.catch((function(e){return e})).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];"validating"===l[e].validateStatus&&(l[e].validateStatus=t.length?"error":"success",l[e].help=t[0])})),n},d=function(r,a){var n=[],i=!0;r?n=Array.isArray(r)?r:[r]:(i=!1,n=Object.keys(t));var o=function(r){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=[],o={},l=function(l){var c=r[l],d=U(e,c,n);if(!d.isValid)return"continue";o[c]=d.v;var f=u(t[c],I(a&&a.trigger));f.length&&i.push(s(c,d.v,f,a||{}).then((function(){return{name:c,errors:[]}})).catch((function(e){return Promise.reject({name:c,errors:e})})))},d=0;d<r.length;d++)l(d);var f=(0,_.v)(i);c=f;var m=f.then((function(){return c===f?Promise.resolve(o):Promise.reject([])})).catch((function(e){var t=e.filter((function(e){return e&&e.errors.length}));return Promise.reject({values:o,errorFields:t,outOfDate:c!==f})}));return m.catch((function(e){return e})),m}(n,a||{},i);return o.catch((function(e){return e})),o},f=o,m=function(e){var r=[];Object.keys(t).forEach((function(t){var a=U(e,t,!1),n=U(f,t,!1);(0,b.Z)(a.v,n.v)||r.push(t)})),d(r,{trigger:"change"}),f=(0,i.Z)(e)},v=null==r?void 0:r.debounce;return(0,n.YP)(e,v&&v.wait?(0,y.Z)(m,v.wait,(0,k.Z)(v,["wait"])):m,{immediate:r&&!!r.immediate,deep:!0}),(0,n.YP)(t,(function(){r&&r.validateOnRuleChange&&d()}),{deep:!0}),{modelRef:e,rulesRef:t,initialModel:o,validateInfos:l,resetFields:function(r){O(e,Z({},(0,i.Z)(o),r)),(0,n.Y3)((function(){Object.keys(l).forEach((function(e){l[e]={autoLink:!1,required:q(t[e])}}))}))},validate:d,validateField:s,mergeValidateInfo:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={autoLink:!1},r=[],a=Array.isArray(e)?e:[e],n=0;n<a.length;n++){var i=a[n];"error"===(null==i?void 0:i.validateStatus)&&(t.validateStatus="error",i.help&&r.push(i.help)),t.required=t.required||(null==i?void 0:i.required)}return t.help=r.join("\n"),t},clearValidate:function(e){(e?Array.isArray(e)?e:[e]:Object.keys(t)).forEach((function(e){l[e]&&O(l[e],{validateStatus:"",help:""})}))}}};r(91033)},13796:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(80707);class n{static login(e){return a.Z.request({url:"/login/account",method:"post",data:e})}static getUserInfo(){return a.Z.request({url:"/currentUser",method:"get"})}static logout(){return a.Z.request({url:"/logout",method:"post"})}static register(e){return a.Z.request({url:"/register",method:"post",data:e})}}},89813:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});var a=r(66252);const n=(0,a.HX)("data-v-2143c238");(0,a.dD)("data-v-2143c238");const i={class:"main login"},o=(0,a.Uk)(" 获取验证码 "),l=(0,a.Uk)(" 自动登录 "),u=(0,a.Uk)(" 忘记密码 "),c=(0,a.Uk)(" 登录 "),s={class:"user-login-other"},d=(0,a.Wm)("span",null,"其他登录方式",-1),f=(0,a.Uk)(" 注册账户 ");(0,a.Cn)();const m=n(((e,t,r,m,v,p)=>{const g=(0,a.up)("a-alert"),h=(0,a.up)("user-outlined"),b=(0,a.up)("a-input"),y=(0,a.up)("a-form-item"),k=(0,a.up)("lock-outlined"),w=(0,a.up)("a-input-password"),W=(0,a.up)("a-tab-pane"),_=(0,a.up)("mobile-outlined"),Z=(0,a.up)("mail-outlined"),j=(0,a.up)("a-col"),O=(0,a.up)("a-button"),q=(0,a.up)("a-row"),I=(0,a.up)("a-tabs"),U=(0,a.up)("a-checkbox"),S=(0,a.up)("router-link"),C=(0,a.up)("alipay-circle-outlined"),A=(0,a.up)("taobao-circle-outlined"),P=(0,a.up)("weibo-circle-outlined"),x=(0,a.up)("a-form");return(0,a.wg)(),(0,a.j4)("div",i,[(0,a.Wm)(x,{layout:"vertical",model:e.form,onSubmit:e.handleSubmit},{default:n((()=>[(0,a.Wm)(I,{"active-key":e.activeKey,"tab-bar-style":{textAlign:"center",borderBottom:"unset"},onChange:e.handleTabClick},{default:n((()=>[(0,a.Wm)(W,{key:0,tab:"账号密码登录"},{default:n((()=>[e.isLoginError?((0,a.wg)(),(0,a.j4)(g,{key:0,type:"error","show-icon":"",style:{"margin-bottom":"24px"},message:"账户或密码错误"})):(0,a.ry)("",!0),(0,a.Wm)(y,e.validateInfos.username,{default:n((()=>[(0,a.Wm)(b,{size:"large",value:e.form.username,"onUpdate:value":t[1]||(t[1]=t=>e.form.username=t),placeholder:"账户: admin"},{prefix:n((()=>[(0,a.Wm)(h,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16),(0,a.Wm)(y,e.validateInfos.password,{default:n((()=>[(0,a.Wm)(w,{size:"large",value:e.form.password,"onUpdate:value":t[2]||(t[2]=t=>e.form.password=t),placeholder:"密码: admin or ant.design"},{prefix:n((()=>[(0,a.Wm)(k,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16)])),_:1}),(0,a.Wm)(W,{key:1,tab:"手机号登录"},{default:n((()=>[(0,a.Wm)(y,e.validateInfos.mobile,{default:n((()=>[(0,a.Wm)(b,{size:"large",value:e.form.mobile,"onUpdate:value":t[3]||(t[3]=t=>e.form.mobile=t),placeholder:"手机号"},{prefix:n((()=>[(0,a.Wm)(_,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16),(0,a.Wm)(q,{gutter:16},{default:n((()=>[(0,a.Wm)(j,{span:16},{default:n((()=>[(0,a.Wm)(y,e.validateInfos.captcha,{default:n((()=>[(0,a.Wm)(b,{size:"large",value:e.form.captcha,"onUpdate:value":t[4]||(t[4]=t=>e.form.captcha=t),placeholder:"验证码"},{prefix:n((()=>[(0,a.Wm)(Z,{style:{color:"rgba(0,0,0,.25)"}},null,8,["style"])])),_:1},8,["value"])])),_:1},16)])),_:1}),(0,a.Wm)(j,{span:8},{default:n((()=>[(0,a.Wm)(O,{size:"large",block:"",onClick:e.getCaptcha},{default:n((()=>[o])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["active-key","onChange"]),(0,a.Wm)(y,null,{default:n((()=>[(0,a.Wm)(U,{checked:e.form.rememberMe,"onUpdate:checked":t[5]||(t[5]=t=>e.form.rememberMe=t)},{default:n((()=>[l])),_:1},8,["checked"]),(0,a.Wm)(S,{to:"/user/login",class:"forge-password",style:{float:"right"}},{default:n((()=>[u])),_:1})])),_:1}),(0,a.Wm)(y,{style:{"margin-top":"24px"}},{default:n((()=>[(0,a.Wm)(O,{size:"large",type:"primary",loading:e.loading,"html-type":"submit",block:""},{default:n((()=>[c])),_:1},8,["loading"])])),_:1}),(0,a.Wm)("div",s,[d,(0,a.Wm)("a",null,[(0,a.Wm)(C,{class:"item-icon"})]),(0,a.Wm)("a",null,[(0,a.Wm)(A,{class:"item-icon"})]),(0,a.Wm)("a",null,[(0,a.Wm)(P,{class:"item-icon"})]),(0,a.Wm)(S,{class:"register",to:"/user/register"},{default:n((()=>[f])),_:1})])])),_:1},8,["model","onSubmit"])])}));var v=r(44854),p=r(80894),g=r(42119),h=r(55518),b=r(13796),y=(0,a.aZ)({name:"login",setup(){const e=(0,p.oR)(),t=(0,g.tv)(),r=(0,v.qj)({activeKey:0,loading:!1,isLoginError:!1}),a=(0,v.qj)({rememberMe:!0,username:"",password:"",mobile:"",captcha:""}),n=(0,v.qj)({rememberMe:void 0,username:[{required:!0,message:"请输入帐户名"}],password:[{required:!0,message:"请输入密码"}],mobile:[{required:!0,pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号"}],captcha:[{required:!0,message:"请输入验证码"}]}),{validateInfos:i,validate:o,resetFields:l}=(0,h.cI)(a,n);return{...(0,v.BK)(r),form:a,validateInfos:i,handleTabClick:function(e){r.activeKey=e,l()},getCaptcha:async function(e){try{e.preventDefault(),await o("mobile")}catch(e){}},handleSubmit:async function(a){try{r.loading=!0,a.preventDefault();const n=0===r.activeKey?["username","password"]:["mobile","captcha"],i=await o(n);i.type=0===r.activeKey?"account":"telephone";const{token:l}=await b.Z.login(i),u=await b.Z.getUserInfo(),{name:c,userid:s,avatar:d}=u;await e.dispatch("setLoginStatus",1),await e.dispatch("setAccessToken",l);const f={username:s,nickname:c,avatar:d,extra:u};await e.dispatch("setUserInfo",f),await t.push({path:"/"}),r.loading=!1}catch(e){r.loading=!1}}}}});y.render=m,y.__scopeId="data-v-2143c238";var k=y}}]);